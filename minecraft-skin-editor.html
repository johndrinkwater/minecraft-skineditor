<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="content-type" content="text/html;charset=utf-8" />
<meta charset="utf-8" />
<title>Minecraft ‐ Skin</title>
<link rel="shortcut icon" type="image/x-icon" href="http://www.minecraft.net/favicon.png" />

<!-- <script type="text/javascript" src="sylvester.js"></script> -->
<script type="text/javascript">

eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('9 17={3i:\'0.1.3\',16:1e-6};l v(){}v.23={e:l(i){8(i<1||i>7.4.q)?w:7.4[i-1]},2R:l(){8 7.4.q},1u:l(){8 F.1x(7.2u(7))},24:l(a){9 n=7.4.q;9 V=a.4||a;o(n!=V.q){8 1L}J{o(F.13(7.4[n-1]-V[n-1])>17.16){8 1L}}H(--n);8 2x},1q:l(){8 v.u(7.4)},1b:l(a){9 b=[];7.28(l(x,i){b.19(a(x,i))});8 v.u(b)},28:l(a){9 n=7.4.q,k=n,i;J{i=k-n;a(7.4[i],i+1)}H(--n)},2q:l(){9 r=7.1u();o(r===0){8 7.1q()}8 7.1b(l(x){8 x/r})},1C:l(a){9 V=a.4||a;9 n=7.4.q,k=n,i;o(n!=V.q){8 w}9 b=0,1D=0,1F=0;7.28(l(x,i){b+=x*V[i-1];1D+=x*x;1F+=V[i-1]*V[i-1]});1D=F.1x(1D);1F=F.1x(1F);o(1D*1F===0){8 w}9 c=b/(1D*1F);o(c<-1){c=-1}o(c>1){c=1}8 F.37(c)},1m:l(a){9 b=7.1C(a);8(b===w)?w:(b<=17.16)},34:l(a){9 b=7.1C(a);8(b===w)?w:(F.13(b-F.1A)<=17.16)},2k:l(a){9 b=7.2u(a);8(b===w)?w:(F.13(b)<=17.16)},2j:l(a){9 V=a.4||a;o(7.4.q!=V.q){8 w}8 7.1b(l(x,i){8 x+V[i-1]})},2C:l(a){9 V=a.4||a;o(7.4.q!=V.q){8 w}8 7.1b(l(x,i){8 x-V[i-1]})},22:l(k){8 7.1b(l(x){8 x*k})},x:l(k){8 7.22(k)},2u:l(a){9 V=a.4||a;9 i,2g=0,n=7.4.q;o(n!=V.q){8 w}J{2g+=7.4[n-1]*V[n-1]}H(--n);8 2g},2f:l(a){9 B=a.4||a;o(7.4.q!=3||B.q!=3){8 w}9 A=7.4;8 v.u([(A[1]*B[2])-(A[2]*B[1]),(A[2]*B[0])-(A[0]*B[2]),(A[0]*B[1])-(A[1]*B[0])])},2A:l(){9 m=0,n=7.4.q,k=n,i;J{i=k-n;o(F.13(7.4[i])>F.13(m)){m=7.4[i]}}H(--n);8 m},2Z:l(x){9 a=w,n=7.4.q,k=n,i;J{i=k-n;o(a===w&&7.4[i]==x){a=i+1}}H(--n);8 a},3g:l(){8 S.2X(7.4)},2d:l(){8 7.1b(l(x){8 F.2d(x)})},2V:l(x){8 7.1b(l(y){8(F.13(y-x)<=17.16)?x:y})},1o:l(a){o(a.K){8 a.1o(7)}9 V=a.4||a;o(V.q!=7.4.q){8 w}9 b=0,2b;7.28(l(x,i){2b=x-V[i-1];b+=2b*2b});8 F.1x(b)},3a:l(a){8 a.1h(7)},2T:l(a){8 a.1h(7)},1V:l(t,a){9 V,R,x,y,z;2S(7.4.q){27 2:V=a.4||a;o(V.q!=2){8 w}R=S.1R(t).4;x=7.4[0]-V[0];y=7.4[1]-V[1];8 v.u([V[0]+R[0][0]*x+R[0][1]*y,V[1]+R[1][0]*x+R[1][1]*y]);1I;27 3:o(!a.U){8 w}9 C=a.1r(7).4;R=S.1R(t,a.U).4;x=7.4[0]-C[0];y=7.4[1]-C[1];z=7.4[2]-C[2];8 v.u([C[0]+R[0][0]*x+R[0][1]*y+R[0][2]*z,C[1]+R[1][0]*x+R[1][1]*y+R[1][2]*z,C[2]+R[2][0]*x+R[2][1]*y+R[2][2]*z]);1I;2P:8 w}},1t:l(a){o(a.K){9 P=7.4.2O();9 C=a.1r(P).4;8 v.u([C[0]+(C[0]-P[0]),C[1]+(C[1]-P[1]),C[2]+(C[2]-(P[2]||0))])}1d{9 Q=a.4||a;o(7.4.q!=Q.q){8 w}8 7.1b(l(x,i){8 Q[i-1]+(Q[i-1]-x)})}},1N:l(){9 V=7.1q();2S(V.4.q){27 3:1I;27 2:V.4.19(0);1I;2P:8 w}8 V},2n:l(){8\'[\'+7.4.2K(\', \')+\']\'},26:l(a){7.4=(a.4||a).2O();8 7}};v.u=l(a){9 V=25 v();8 V.26(a)};v.i=v.u([1,0,0]);v.j=v.u([0,1,0]);v.k=v.u([0,0,1]);v.2J=l(n){9 a=[];J{a.19(F.2F())}H(--n);8 v.u(a)};v.1j=l(n){9 a=[];J{a.19(0)}H(--n);8 v.u(a)};l S(){}S.23={e:l(i,j){o(i<1||i>7.4.q||j<1||j>7.4[0].q){8 w}8 7.4[i-1][j-1]},33:l(i){o(i>7.4.q){8 w}8 v.u(7.4[i-1])},2E:l(j){o(j>7.4[0].q){8 w}9 a=[],n=7.4.q,k=n,i;J{i=k-n;a.19(7.4[i][j-1])}H(--n);8 v.u(a)},2R:l(){8{2D:7.4.q,1p:7.4[0].q}},2D:l(){8 7.4.q},1p:l(){8 7.4[0].q},24:l(a){9 M=a.4||a;o(1g(M[0][0])==\'1f\'){M=S.u(M).4}o(7.4.q!=M.q||7.4[0].q!=M[0].q){8 1L}9 b=7.4.q,15=b,i,G,10=7.4[0].q,j;J{i=15-b;G=10;J{j=10-G;o(F.13(7.4[i][j]-M[i][j])>17.16){8 1L}}H(--G)}H(--b);8 2x},1q:l(){8 S.u(7.4)},1b:l(a){9 b=[],12=7.4.q,15=12,i,G,10=7.4[0].q,j;J{i=15-12;G=10;b[i]=[];J{j=10-G;b[i][j]=a(7.4[i][j],i+1,j+1)}H(--G)}H(--12);8 S.u(b)},2i:l(a){9 M=a.4||a;o(1g(M[0][0])==\'1f\'){M=S.u(M).4}8(7.4.q==M.q&&7.4[0].q==M[0].q)},2j:l(a){9 M=a.4||a;o(1g(M[0][0])==\'1f\'){M=S.u(M).4}o(!7.2i(M)){8 w}8 7.1b(l(x,i,j){8 x+M[i-1][j-1]})},2C:l(a){9 M=a.4||a;o(1g(M[0][0])==\'1f\'){M=S.u(M).4}o(!7.2i(M)){8 w}8 7.1b(l(x,i,j){8 x-M[i-1][j-1]})},2B:l(a){9 M=a.4||a;o(1g(M[0][0])==\'1f\'){M=S.u(M).4}8(7.4[0].q==M.q)},22:l(a){o(!a.4){8 7.1b(l(x){8 x*a})}9 b=a.1u?2x:1L;9 M=a.4||a;o(1g(M[0][0])==\'1f\'){M=S.u(M).4}o(!7.2B(M)){8 w}9 d=7.4.q,15=d,i,G,10=M[0].q,j;9 e=7.4[0].q,4=[],21,20,c;J{i=15-d;4[i]=[];G=10;J{j=10-G;21=0;20=e;J{c=e-20;21+=7.4[i][c]*M[c][j]}H(--20);4[i][j]=21}H(--G)}H(--d);9 M=S.u(4);8 b?M.2E(1):M},x:l(a){8 7.22(a)},32:l(a,b,c,d){9 e=[],12=c,i,G,j;9 f=7.4.q,1p=7.4[0].q;J{i=c-12;e[i]=[];G=d;J{j=d-G;e[i][j]=7.4[(a+i-1)%f][(b+j-1)%1p]}H(--G)}H(--12);8 S.u(e)},31:l(){9 a=7.4.q,1p=7.4[0].q;9 b=[],12=1p,i,G,j;J{i=1p-12;b[i]=[];G=a;J{j=a-G;b[i][j]=7.4[j][i]}H(--G)}H(--12);8 S.u(b)},1y:l(){8(7.4.q==7.4[0].q)},2A:l(){9 m=0,12=7.4.q,15=12,i,G,10=7.4[0].q,j;J{i=15-12;G=10;J{j=10-G;o(F.13(7.4[i][j])>F.13(m)){m=7.4[i][j]}}H(--G)}H(--12);8 m},2Z:l(x){9 a=w,12=7.4.q,15=12,i,G,10=7.4[0].q,j;J{i=15-12;G=10;J{j=10-G;o(7.4[i][j]==x){8{i:i+1,j:j+1}}}H(--G)}H(--12);8 w},30:l(){o(!7.1y){8 w}9 a=[],n=7.4.q,k=n,i;J{i=k-n;a.19(7.4[i][i])}H(--n);8 v.u(a)},1K:l(){9 M=7.1q(),1c;9 n=7.4.q,k=n,i,1s,1n=7.4[0].q,p;J{i=k-n;o(M.4[i][i]==0){2e(j=i+1;j<k;j++){o(M.4[j][i]!=0){1c=[];1s=1n;J{p=1n-1s;1c.19(M.4[i][p]+M.4[j][p])}H(--1s);M.4[i]=1c;1I}}}o(M.4[i][i]!=0){2e(j=i+1;j<k;j++){9 a=M.4[j][i]/M.4[i][i];1c=[];1s=1n;J{p=1n-1s;1c.19(p<=i?0:M.4[j][p]-M.4[i][p]*a)}H(--1s);M.4[j]=1c}}}H(--n);8 M},3h:l(){8 7.1K()},2z:l(){o(!7.1y()){8 w}9 M=7.1K();9 a=M.4[0][0],n=M.4.q-1,k=n,i;J{i=k-n+1;a=a*M.4[i][i]}H(--n);8 a},3f:l(){8 7.2z()},2y:l(){8(7.1y()&&7.2z()===0)},2Y:l(){o(!7.1y()){8 w}9 a=7.4[0][0],n=7.4.q-1,k=n,i;J{i=k-n+1;a+=7.4[i][i]}H(--n);8 a},3e:l(){8 7.2Y()},1Y:l(){9 M=7.1K(),1Y=0;9 a=7.4.q,15=a,i,G,10=7.4[0].q,j;J{i=15-a;G=10;J{j=10-G;o(F.13(M.4[i][j])>17.16){1Y++;1I}}H(--G)}H(--a);8 1Y},3d:l(){8 7.1Y()},2W:l(a){9 M=a.4||a;o(1g(M[0][0])==\'1f\'){M=S.u(M).4}9 T=7.1q(),1p=T.4[0].q;9 b=T.4.q,15=b,i,G,10=M[0].q,j;o(b!=M.q){8 w}J{i=15-b;G=10;J{j=10-G;T.4[i][1p+j]=M[i][j]}H(--G)}H(--b);8 T},2w:l(){o(!7.1y()||7.2y()){8 w}9 a=7.4.q,15=a,i,j;9 M=7.2W(S.I(a)).1K();9 b,1n=M.4[0].q,p,1c,2v;9 c=[],2c;J{i=a-1;1c=[];b=1n;c[i]=[];2v=M.4[i][i];J{p=1n-b;2c=M.4[i][p]/2v;1c.19(2c);o(p>=15){c[i].19(2c)}}H(--b);M.4[i]=1c;2e(j=0;j<i;j++){1c=[];b=1n;J{p=1n-b;1c.19(M.4[j][p]-M.4[i][p]*M.4[j][i])}H(--b);M.4[j]=1c}}H(--a);8 S.u(c)},3c:l(){8 7.2w()},2d:l(){8 7.1b(l(x){8 F.2d(x)})},2V:l(x){8 7.1b(l(p){8(F.13(p-x)<=17.16)?x:p})},2n:l(){9 a=[];9 n=7.4.q,k=n,i;J{i=k-n;a.19(v.u(7.4[i]).2n())}H(--n);8 a.2K(\'\\n\')},26:l(a){9 i,4=a.4||a;o(1g(4[0][0])!=\'1f\'){9 b=4.q,15=b,G,10,j;7.4=[];J{i=15-b;G=4[i].q;10=G;7.4[i]=[];J{j=10-G;7.4[i][j]=4[i][j]}H(--G)}H(--b);8 7}9 n=4.q,k=n;7.4=[];J{i=k-n;7.4.19([4[i]])}H(--n);8 7}};S.u=l(a){9 M=25 S();8 M.26(a)};S.I=l(n){9 a=[],k=n,i,G,j;J{i=k-n;a[i]=[];G=k;J{j=k-G;a[i][j]=(i==j)?1:0}H(--G)}H(--n);8 S.u(a)};S.2X=l(a){9 n=a.q,k=n,i;9 M=S.I(n);J{i=k-n;M.4[i][i]=a[i]}H(--n);8 M};S.1R=l(b,a){o(!a){8 S.u([[F.1H(b),-F.1G(b)],[F.1G(b),F.1H(b)]])}9 d=a.1q();o(d.4.q!=3){8 w}9 e=d.1u();9 x=d.4[0]/e,y=d.4[1]/e,z=d.4[2]/e;9 s=F.1G(b),c=F.1H(b),t=1-c;8 S.u([[t*x*x+c,t*x*y-s*z,t*x*z+s*y],[t*x*y+s*z,t*y*y+c,t*y*z-s*x],[t*x*z-s*y,t*y*z+s*x,t*z*z+c]])};S.3b=l(t){9 c=F.1H(t),s=F.1G(t);8 S.u([[1,0,0],[0,c,-s],[0,s,c]])};S.39=l(t){9 c=F.1H(t),s=F.1G(t);8 S.u([[c,0,s],[0,1,0],[-s,0,c]])};S.38=l(t){9 c=F.1H(t),s=F.1G(t);8 S.u([[c,-s,0],[s,c,0],[0,0,1]])};S.2J=l(n,m){8 S.1j(n,m).1b(l(){8 F.2F()})};S.1j=l(n,m){9 a=[],12=n,i,G,j;J{i=n-12;a[i]=[];G=m;J{j=m-G;a[i][j]=0}H(--G)}H(--12);8 S.u(a)};l 14(){}14.23={24:l(a){8(7.1m(a)&&7.1h(a.K))},1q:l(){8 14.u(7.K,7.U)},2U:l(a){9 V=a.4||a;8 14.u([7.K.4[0]+V[0],7.K.4[1]+V[1],7.K.4[2]+(V[2]||0)],7.U)},1m:l(a){o(a.W){8 a.1m(7)}9 b=7.U.1C(a.U);8(F.13(b)<=17.16||F.13(b-F.1A)<=17.16)},1o:l(a){o(a.W){8 a.1o(7)}o(a.U){o(7.1m(a)){8 7.1o(a.K)}9 N=7.U.2f(a.U).2q().4;9 A=7.K.4,B=a.K.4;8 F.13((A[0]-B[0])*N[0]+(A[1]-B[1])*N[1]+(A[2]-B[2])*N[2])}1d{9 P=a.4||a;9 A=7.K.4,D=7.U.4;9 b=P[0]-A[0],2a=P[1]-A[1],29=(P[2]||0)-A[2];9 c=F.1x(b*b+2a*2a+29*29);o(c===0)8 0;9 d=(b*D[0]+2a*D[1]+29*D[2])/c;9 e=1-d*d;8 F.13(c*F.1x(e<0?0:e))}},1h:l(a){9 b=7.1o(a);8(b!==w&&b<=17.16)},2T:l(a){8 a.1h(7)},1v:l(a){o(a.W){8 a.1v(7)}8(!7.1m(a)&&7.1o(a)<=17.16)},1U:l(a){o(a.W){8 a.1U(7)}o(!7.1v(a)){8 w}9 P=7.K.4,X=7.U.4,Q=a.K.4,Y=a.U.4;9 b=X[0],1z=X[1],1B=X[2],1T=Y[0],1S=Y[1],1M=Y[2];9 c=P[0]-Q[0],2s=P[1]-Q[1],2r=P[2]-Q[2];9 d=-b*c-1z*2s-1B*2r;9 e=1T*c+1S*2s+1M*2r;9 f=b*b+1z*1z+1B*1B;9 g=1T*1T+1S*1S+1M*1M;9 h=b*1T+1z*1S+1B*1M;9 k=(d*g/f+h*e)/(g-h*h);8 v.u([P[0]+k*b,P[1]+k*1z,P[2]+k*1B])},1r:l(a){o(a.U){o(7.1v(a)){8 7.1U(a)}o(7.1m(a)){8 w}9 D=7.U.4,E=a.U.4;9 b=D[0],1l=D[1],1k=D[2],1P=E[0],1O=E[1],1Q=E[2];9 x=(1k*1P-b*1Q),y=(b*1O-1l*1P),z=(1l*1Q-1k*1O);9 N=v.u([x*1Q-y*1O,y*1P-z*1Q,z*1O-x*1P]);9 P=11.u(a.K,N);8 P.1U(7)}1d{9 P=a.4||a;o(7.1h(P)){8 v.u(P)}9 A=7.K.4,D=7.U.4;9 b=D[0],1l=D[1],1k=D[2],1w=A[0],18=A[1],1a=A[2];9 x=b*(P[1]-18)-1l*(P[0]-1w),y=1l*((P[2]||0)-1a)-1k*(P[1]-18),z=1k*(P[0]-1w)-b*((P[2]||0)-1a);9 V=v.u([1l*x-1k*z,1k*y-b*x,b*z-1l*y]);9 k=7.1o(P)/V.1u();8 v.u([P[0]+V.4[0]*k,P[1]+V.4[1]*k,(P[2]||0)+V.4[2]*k])}},1V:l(t,a){o(1g(a.U)==\'1f\'){a=14.u(a.1N(),v.k)}9 R=S.1R(t,a.U).4;9 C=a.1r(7.K).4;9 A=7.K.4,D=7.U.4;9 b=C[0],1E=C[1],1J=C[2],1w=A[0],18=A[1],1a=A[2];9 x=1w-b,y=18-1E,z=1a-1J;8 14.u([b+R[0][0]*x+R[0][1]*y+R[0][2]*z,1E+R[1][0]*x+R[1][1]*y+R[1][2]*z,1J+R[2][0]*x+R[2][1]*y+R[2][2]*z],[R[0][0]*D[0]+R[0][1]*D[1]+R[0][2]*D[2],R[1][0]*D[0]+R[1][1]*D[1]+R[1][2]*D[2],R[2][0]*D[0]+R[2][1]*D[1]+R[2][2]*D[2]])},1t:l(a){o(a.W){9 A=7.K.4,D=7.U.4;9 b=A[0],18=A[1],1a=A[2],2N=D[0],1l=D[1],1k=D[2];9 c=7.K.1t(a).4;9 d=b+2N,2h=18+1l,2o=1a+1k;9 Q=a.1r([d,2h,2o]).4;9 e=[Q[0]+(Q[0]-d)-c[0],Q[1]+(Q[1]-2h)-c[1],Q[2]+(Q[2]-2o)-c[2]];8 14.u(c,e)}1d o(a.U){8 7.1V(F.1A,a)}1d{9 P=a.4||a;8 14.u(7.K.1t([P[0],P[1],(P[2]||0)]),7.U)}},1Z:l(a,b){a=v.u(a);b=v.u(b);o(a.4.q==2){a.4.19(0)}o(b.4.q==2){b.4.19(0)}o(a.4.q>3||b.4.q>3){8 w}9 c=b.1u();o(c===0){8 w}7.K=a;7.U=v.u([b.4[0]/c,b.4[1]/c,b.4[2]/c]);8 7}};14.u=l(a,b){9 L=25 14();8 L.1Z(a,b)};14.X=14.u(v.1j(3),v.i);14.Y=14.u(v.1j(3),v.j);14.Z=14.u(v.1j(3),v.k);l 11(){}11.23={24:l(a){8(7.1h(a.K)&&7.1m(a))},1q:l(){8 11.u(7.K,7.W)},2U:l(a){9 V=a.4||a;8 11.u([7.K.4[0]+V[0],7.K.4[1]+V[1],7.K.4[2]+(V[2]||0)],7.W)},1m:l(a){9 b;o(a.W){b=7.W.1C(a.W);8(F.13(b)<=17.16||F.13(F.1A-b)<=17.16)}1d o(a.U){8 7.W.2k(a.U)}8 w},2k:l(a){9 b=7.W.1C(a.W);8(F.13(F.1A/2-b)<=17.16)},1o:l(a){o(7.1v(a)||7.1h(a)){8 0}o(a.K){9 A=7.K.4,B=a.K.4,N=7.W.4;8 F.13((A[0]-B[0])*N[0]+(A[1]-B[1])*N[1]+(A[2]-B[2])*N[2])}1d{9 P=a.4||a;9 A=7.K.4,N=7.W.4;8 F.13((A[0]-P[0])*N[0]+(A[1]-P[1])*N[1]+(A[2]-(P[2]||0))*N[2])}},1h:l(a){o(a.W){8 w}o(a.U){8(7.1h(a.K)&&7.1h(a.K.2j(a.U)))}1d{9 P=a.4||a;9 A=7.K.4,N=7.W.4;9 b=F.13(N[0]*(A[0]-P[0])+N[1]*(A[1]-P[1])+N[2]*(A[2]-(P[2]||0)));8(b<=17.16)}},1v:l(a){o(1g(a.U)==\'1f\'&&1g(a.W)==\'1f\'){8 w}8!7.1m(a)},1U:l(a){o(!7.1v(a)){8 w}o(a.U){9 A=a.K.4,D=a.U.4,P=7.K.4,N=7.W.4;9 b=(N[0]*(P[0]-A[0])+N[1]*(P[1]-A[1])+N[2]*(P[2]-A[2]))/(N[0]*D[0]+N[1]*D[1]+N[2]*D[2]);8 v.u([A[0]+D[0]*b,A[1]+D[1]*b,A[2]+D[2]*b])}1d o(a.W){9 c=7.W.2f(a.W).2q();9 N=7.W.4,A=7.K.4,O=a.W.4,B=a.K.4;9 d=S.1j(2,2),i=0;H(d.2y()){i++;d=S.u([[N[i%3],N[(i+1)%3]],[O[i%3],O[(i+1)%3]]])}9 e=d.2w().4;9 x=N[0]*A[0]+N[1]*A[1]+N[2]*A[2];9 y=O[0]*B[0]+O[1]*B[1]+O[2]*B[2];9 f=[e[0][0]*x+e[0][1]*y,e[1][0]*x+e[1][1]*y];9 g=[];2e(9 j=1;j<=3;j++){g.19((i==j)?0:f[(j+(5-i)%3)%3])}8 14.u(g,c)}},1r:l(a){9 P=a.4||a;9 A=7.K.4,N=7.W.4;9 b=(A[0]-P[0])*N[0]+(A[1]-P[1])*N[1]+(A[2]-(P[2]||0))*N[2];8 v.u([P[0]+N[0]*b,P[1]+N[1]*b,(P[2]||0)+N[2]*b])},1V:l(t,a){9 R=S.1R(t,a.U).4;9 C=a.1r(7.K).4;9 A=7.K.4,N=7.W.4;9 b=C[0],1E=C[1],1J=C[2],1w=A[0],18=A[1],1a=A[2];9 x=1w-b,y=18-1E,z=1a-1J;8 11.u([b+R[0][0]*x+R[0][1]*y+R[0][2]*z,1E+R[1][0]*x+R[1][1]*y+R[1][2]*z,1J+R[2][0]*x+R[2][1]*y+R[2][2]*z],[R[0][0]*N[0]+R[0][1]*N[1]+R[0][2]*N[2],R[1][0]*N[0]+R[1][1]*N[1]+R[1][2]*N[2],R[2][0]*N[0]+R[2][1]*N[1]+R[2][2]*N[2]])},1t:l(a){o(a.W){9 A=7.K.4,N=7.W.4;9 b=A[0],18=A[1],1a=A[2],2M=N[0],2L=N[1],2Q=N[2];9 c=7.K.1t(a).4;9 d=b+2M,2p=18+2L,2m=1a+2Q;9 Q=a.1r([d,2p,2m]).4;9 e=[Q[0]+(Q[0]-d)-c[0],Q[1]+(Q[1]-2p)-c[1],Q[2]+(Q[2]-2m)-c[2]];8 11.u(c,e)}1d o(a.U){8 7.1V(F.1A,a)}1d{9 P=a.4||a;8 11.u(7.K.1t([P[0],P[1],(P[2]||0)]),7.W)}},1Z:l(a,b,c){a=v.u(a);a=a.1N();o(a===w){8 w}b=v.u(b);b=b.1N();o(b===w){8 w}o(1g(c)==\'1f\'){c=w}1d{c=v.u(c);c=c.1N();o(c===w){8 w}}9 d=a.4[0],18=a.4[1],1a=a.4[2];9 e=b.4[0],1W=b.4[1],1X=b.4[2];9 f,1i;o(c!==w){9 g=c.4[0],2l=c.4[1],2t=c.4[2];f=v.u([(1W-18)*(2t-1a)-(1X-1a)*(2l-18),(1X-1a)*(g-d)-(e-d)*(2t-1a),(e-d)*(2l-18)-(1W-18)*(g-d)]);1i=f.1u();o(1i===0){8 w}f=v.u([f.4[0]/1i,f.4[1]/1i,f.4[2]/1i])}1d{1i=F.1x(e*e+1W*1W+1X*1X);o(1i===0){8 w}f=v.u([b.4[0]/1i,b.4[1]/1i,b.4[2]/1i])}7.K=a;7.W=f;8 7}};11.u=l(a,b,c){9 P=25 11();8 P.1Z(a,b,c)};11.2I=11.u(v.1j(3),v.k);11.2H=11.u(v.1j(3),v.i);11.2G=11.u(v.1j(3),v.j);11.36=11.2I;11.35=11.2H;11.3j=11.2G;9 $V=v.u;9 $M=S.u;9 $L=14.u;9 $P=11.u;',62,206,'||||elements|||this|return|var||||||||||||function|||if||length||||create|Vector|null|||||||||Math|nj|while||do|anchor||||||||Matrix||direction||normal||||kj|Plane|ni|abs|Line|ki|precision|Sylvester|A2|push|A3|map|els|else||undefined|typeof|contains|mod|Zero|D3|D2|isParallelTo|kp|distanceFrom|cols|dup|pointClosestTo|np|reflectionIn|modulus|intersects|A1|sqrt|isSquare|X2|PI|X3|angleFrom|mod1|C2|mod2|sin|cos|break|C3|toRightTriangular|false|Y3|to3D|E2|E1|E3|Rotation|Y2|Y1|intersectionWith|rotate|v12|v13|rank|setVectors|nc|sum|multiply|prototype|eql|new|setElements|case|each|PA3|PA2|part|new_element|round|for|cross|product|AD2|isSameSizeAs|add|isPerpendicularTo|v22|AN3|inspect|AD3|AN2|toUnitVector|PsubQ3|PsubQ2|v23|dot|divisor|inverse|true|isSingular|determinant|max|canMultiplyFromLeft|subtract|rows|col|random|ZX|YZ|XY|Random|join|N2|N1|D1|slice|default|N3|dimensions|switch|liesIn|translate|snapTo|augment|Diagonal|trace|indexOf|diagonal|transpose|minor|row|isAntiparallelTo|ZY|YX|acos|RotationZ|RotationY|liesOn|RotationX|inv|rk|tr|det|toDiagonalMatrix|toUpperTriangular|version|XZ'.split('|'),0,{}))
</script>

<!-- <script type="text/javascript" src="glUtils.js"></script> -->

<script type="text/javascript">
// augment Sylvester some
Matrix.Translation = function (v)
{
	if (v.elements.length == 2) {
		var r = Matrix.I(3);
		r.elements[2][0] = v.elements[0];
		r.elements[2][1] = v.elements[1];
		return r;
	}

	if (v.elements.length == 3) {
		var r = Matrix.I(4);
		r.elements[0][3] = v.elements[0];
		r.elements[1][3] = v.elements[1];
		r.elements[2][3] = v.elements[2];
		return r;
	}

	throw "Invalid length for Translation";
}

Matrix.prototype.flatten = function ()
{
		var result = [];
		if (this.elements.length == 0)
				return [];


		for (var j = 0; j < this.elements[0].length; j++)
				for (var i = 0; i < this.elements.length; i++)
						result.push(this.elements[i][j]);
		return result;
}

Matrix.prototype.ensure4x4 = function()
{
	if (this.elements.length == 4 &&
		this.elements[0].length == 4)
		return this;

	if (this.elements.length > 4 ||
		this.elements[0].length > 4)
		return null;

	for (var i = 0; i < this.elements.length; i++) {
		for (var j = this.elements[i].length; j < 4; j++) {
			if (i == j)
				this.elements[i].push(1);
			else
				this.elements[i].push(0);
		}
	}

	for (var i = this.elements.length; i < 4; i++) {
		if (i == 0)
			this.elements.push([1, 0, 0, 0]);
		else if (i == 1)
			this.elements.push([0, 1, 0, 0]);
		else if (i == 2)
			this.elements.push([0, 0, 1, 0]);
		else if (i == 3)
			this.elements.push([0, 0, 0, 1]);
	}

	return this;
};

Matrix.prototype.make3x3 = function()
{
	if (this.elements.length != 4 || this.elements[0].length != 4)
		return null;

	return Matrix.create([[this.elements[0][0], this.elements[0][1], this.elements[0][2]],
						[this.elements[1][0], this.elements[1][1], this.elements[1][2]],
						[this.elements[2][0], this.elements[2][1], this.elements[2][2]]]);
};

Vector.prototype.flatten = function ()
{
	return this.elements;
};


//
// gluLookAt
//
function makeLookAt(ex, ey, ez, cx, cy, cz,	ux, uy, uz) {
	var eye = $V([ex, ey, ez]);
	var center = $V([cx, cy, cz]);
	var up = $V([ux, uy, uz]);

	var mag;

	var z = eye.subtract(center).toUnitVector();
	var x = up.cross(z).toUnitVector();
	var y = z.cross(x).toUnitVector();

	var m = $M([[x.e(1), x.e(2), x.e(3), 0],
				[y.e(1), y.e(2), y.e(3), 0],
				[z.e(1), z.e(2), z.e(3), 0],
				[0, 0, 0, 1]]);

	var t = $M([[1, 0, 0, -ex],
				[0, 1, 0, -ey],
				[0, 0, 1, -ez],
				[0, 0, 0, 1]]);
	return m.x(t);
}

//
// gluPerspective
//
function makePerspective(fovy, aspect, znear, zfar)
{
	var ymax = znear * Math.tan(fovy * Math.PI / 360.0);
	var ymin = -ymax;
	var xmin = ymin * aspect;
	var xmax = ymax * aspect;

	return makeFrustum(xmin, xmax, ymin, ymax, znear, zfar);
}

//
// glFrustum
//
function makeFrustum(left, right,
										 bottom, top,
										 znear, zfar)
{
		var X = 2*znear/(right-left);
		var Y = 2*znear/(top-bottom);
		var A = (right+left)/(right-left);
		var B = (top+bottom)/(top-bottom);
		var C = -(zfar+znear)/(zfar-znear);
		var D = -2*zfar*znear/(zfar-znear);

		return $M([[X, 0, A, 0],
							 [0, Y, B, 0],
							 [0, 0, C, D],
							 [0, 0, -1, 0]]);
}

//
// glOrtho
//
function makeOrtho(left, right, bottom, top, znear, zfar)
{
		var tx = - (right + left) / (right - left);
		var ty = - (top + bottom) / (top - bottom);
		var tz = - (zfar + znear) / (zfar - znear);

		return $M([[2 / (right - left), 0, 0, tx],
					 [0, 2 / (top - bottom), 0, ty],
					 [0, 0, -2 / (zfar - znear), tz],
					 [0, 0, 0, 1]]);
}

</script>

<script id="shader-fs" type="x-shader/x-fragment">
#ifdef GL_ES
precision highp float;
#endif

varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void) {
gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
}
</script>

<script id="shader-vs" type="x-shader/x-vertex">
attribute vec3 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat4 uMVMatrix;
uniform mat4 uPMatrix;

varying vec2 vTextureCoord;

void main(void) {
gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
vTextureCoord = aTextureCoord;
}
</script>


<script type="text/javascript">

	var gl;
	function initGL(canvas) {
		try {
			gl = canvas.getContext("experimental-webgl");
			gl.viewportWidth = canvas.width;
			gl.viewportHeight = canvas.height;
		} catch(e) { }
		if (!gl) {
			console.log("Could not initialise WebGL, sorry :-(");
			return null;
		}
		return gl;
	}


	function getShader(gl, id) {
		var shaderScript = document.getElementById(id);
		if (!shaderScript) {
			return null;
		}

		var str = "";
		var k = shaderScript.firstChild;
		while (k) {
			if (k.nodeType == 3) {
				str += k.textContent;
			}
			k = k.nextSibling;
		}

		var shader;
		if (shaderScript.type == "x-shader/x-fragment") {
			shader = gl.createShader(gl.FRAGMENT_SHADER);
		} else if (shaderScript.type == "x-shader/x-vertex") {
			shader = gl.createShader(gl.VERTEX_SHADER);
		} else {
			return null;
		}

		gl.shaderSource(shader, str);
		gl.compileShader(shader);

		if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
			console.log(gl.getShaderInfoLog(shader));
			return null;
		}

		return shader;
	}


	var shaderProgram;
	function initShaders() {
		var fragmentShader = getShader(gl, "shader-fs");
		var vertexShader = getShader(gl, "shader-vs");

		shaderProgram = gl.createProgram();
		gl.attachShader(shaderProgram, vertexShader);
		gl.attachShader(shaderProgram, fragmentShader);
		gl.linkProgram(shaderProgram);

		if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {
			console.log("Could not initialise shaders");
		}

		gl.useProgram(shaderProgram);

		shaderProgram.vertexPositionAttribute = gl.getAttribLocation(shaderProgram, "aVertexPosition");
		gl.enableVertexAttribArray(shaderProgram.vertexPositionAttribute);

		shaderProgram.textureCoordAttribute = gl.getAttribLocation(shaderProgram, "aTextureCoord");
		gl.enableVertexAttribArray(shaderProgram.textureCoordAttribute);

		shaderProgram.pMatrixUniform = gl.getUniformLocation(shaderProgram, "uPMatrix");
		shaderProgram.mvMatrixUniform = gl.getUniformLocation(shaderProgram, "uMVMatrix");
		shaderProgram.samplerUniform = gl.getUniformLocation(shaderProgram, "uSampler");

	}


	var mvMatrix;
	var mvMatrixStack = [];

	function mvPushMatrix(m) {
		if (m) {
			mvMatrixStack.push(m.dup());
			mvMatrix = m.dup();
		} else {
			mvMatrixStack.push(mvMatrix.dup());
		}
	}

	function mvPopMatrix() {
		if (mvMatrixStack.length == 0) {
			throw "Invalid popMatrix!";
		}
		mvMatrix = mvMatrixStack.pop();
		return mvMatrix;
	}

	function loadIdentity() {
		mvMatrix = Matrix.I(4);
	}


	function multMatrix(m) {
		mvMatrix = mvMatrix.x(m);
	}

	function mvTranslate(v) {
		var m = Matrix.Translation($V([v[0], v[1], v[2]])).ensure4x4();
		multMatrix(m);
	}
	function mvTranslateN(v) {
		var m = Matrix.Translation($V([-v[0], -v[1], -v[2]])).ensure4x4();
		multMatrix(m);
	}
	function mvScale(v) {
		var m = Matrix.Diagonal([v[0], v[1], v[2], 1]);
		multMatrix(m);
	}
	function mvInvert() {
		mvMatrix = mvMatrix.inv();
	}

	function mvRotate(ang, v) {
		var arad = ang * Math.PI / 180.0;
		var m = Matrix.Rotation(arad, $V([v[0], v[1], v[2]])).ensure4x4();
		multMatrix(m);
	}
	function mvRotateAbout(ang, v, v2) {
		mvTranslate(v2);
		mvRotate(ang, v);
		mvTranslateN(v2);
	}

	var pMatrix;
	function perspective(fovy, aspect, znear, zfar) {
		pMatrix = makePerspective(fovy, aspect, znear, zfar);
	}


	function setMatrixUniforms() {
		gl.uniformMatrix4fv(shaderProgram.pMatrixUniform, false, new Float32Array(pMatrix.flatten()));
		gl.uniformMatrix4fv(shaderProgram.mvMatrixUniform, false, new Float32Array(mvMatrix.flatten()));
	}

	/*
	 * helper function, just to reduce code size
	 */
	function makeCube(width, height, depth) {
		// we are passed in something like 8, 10, 12.
		// we convert these to floats, based around 8!
		var w,h,d;
		w = width / 8;
		h = height / 8;
		d = depth / 8;

		var buffer = gl.createBuffer();
		gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
		vertices = [
			// Front face
			-w,-h, d, w,-h, d, w, h, d,-w, h, d,
			// Back face
			-w,-h,-d,-w, h,-d, w, h,-d, w,-h,-d,
			// Top face
			-w, h,-d,-w, h, d, w, h, d, w, h,-d,
			// Bottom face
			-w,-h,-d, w,-h,-d, w,-h, d,-w,-h, d,
			// Right face
			 w,-h,-d, w, h,-d, w, h, d, w,-h, d,
			// Left face
			-w,-h,-d,-w,-h, d,-w, h, d,-w, h,-d,
		];
		gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);
		buffer.itemSize = 3;
		buffer.numItems = 24;
		return buffer;
	}


	var cubeVPB, bodyVPB, armVPB, legVPB;
	var headVTCB, headAccessVTCB, bodyVTCB, armLVTCB, legVTCB;
	var cubeVertexIndexBuffer;
	function initBuffers() {

		// for head, and head accessories
		cubeVPB = makeCube( 8, 8, 8);
		// body, unsure what ‘depth’ body should be
		bodyVPB = makeCube( 8,12, 4);
		armVPB	= makeCube( 4,12, 4);
		legVPB	= makeCube( 4,12, 4);

		skintexture = gl.createTexture();

		// for the following, what we could do to make it more readable/flexible,
		// is store it in ints for x/y, then divide by 64 or 32, depending.
		headVTCB = gl.createBuffer();
		gl.bindBuffer(gl.ARRAY_BUFFER, headVTCB);
		var textureCoords = [
			0.125, 0.5,	 0.25, 0.5,	 0.25, 0.75,	 0.125, 0.75,
			0.5, 0.5,		 0.5, 0.75,	 0.375, 0.75,	0.375, 0.5,
			0.125, 1.0,	 0.125, 0.75, 0.25, 0.75,	 0.25, 1.0,
			0.375, 1.0,	 0.25, 1.0,	 0.25, 0.75,	 0.375, 0.75,
			0.375, 0.5,	 0.375, 0.75, 0.25, 0.75,	 0.25, 0.5,
			0.0, 0.5,		 0.125, 0.5,	0.125, 0.75,	0.0, 0.75,
		];
		gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(textureCoords), gl.STATIC_DRAW);
		headVTCB.itemSize = 2;
		headVTCB.numItems = 24;

		headAccessVTCB = gl.createBuffer();
		gl.bindBuffer(gl.ARRAY_BUFFER, headAccessVTCB);
		var textureCoords = [
			0.625, 0.5,	0.75, 0.5,	 0.75, 0.75,	 0.625, 0.75,
			1.0, 0.5,		1.0, 0.75,	 0.875, 0.75,	0.875, 0.5,
			0.625, 1.0,	0.625, 0.75, 0.75, 0.75,	 0.75, 1.0,
			0.875, 1.0,	0.75, 1.0,	 0.75, 0.75,	 0.875, 0.75,
			0.875, 0.5,	0.875, 0.75, 0.75, 0.75,	 0.75, 0.5,
			0.5, 0.5,		0.625, 0.5,	0.625, 0.75,	0.5, 0.75,
		];
		gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(textureCoords), gl.STATIC_DRAW);
		headAccessVTCB.itemSize = 2;
		headAccessVTCB.numItems = 24;

		bodyVTCB = gl.createBuffer();
		gl.bindBuffer(gl.ARRAY_BUFFER, bodyVTCB);
		var textureCoords = [
			0.3125, 0.0, 0.4375, 0.0, 0.4375, 0.375, 0.3125, 0.375,
			0.625, 0.0, 0.625, 0.375, 0.5, 0.375, 0.5, 0.0,
			0.3125, 0.5, 0.3125, 0.375, 0.4375, 0.375, 0.4375, 0.5,
			0.5625, 0.5, 0.4375, 0.5, 0.4375, 0.375, 0.5625, 0.375,
			0.5, 0.0, 0.5, 0.375, 0.4375, 0.375, 0.4375, 0.0,
			0.25, 0.0, 0.3125, 0.0, 0.3125, 0.375, 0.25, 0.375,
		];
		gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(textureCoords), gl.STATIC_DRAW);
		bodyVTCB.itemSize = 2;
		bodyVTCB.numItems = 24;


		armLVTCB = gl.createBuffer();
		gl.bindBuffer(gl.ARRAY_BUFFER, armLVTCB);
		var textureCoords = [
			0.6875, 0.0, 0.75, 0.0,	0.75, 0.375, 0.6875, 0.375,
			0.875, 0.0,	0.875, 0.375, 0.8125, 0.375, 0.8125, 0.0,
			0.6875, 0.5, 0.6875, 0.375,0.75, 0.375,0.75, 0.5,
			0.8125, 0.5, 0.75, 0.5, 0.75, 0.375, 0.8125, 0.375,
			0.8125, 0.0, 0.8125, 0.375, 0.75, 0.375, 0.75, 0.0,
			0.625, 0.0,	0.6875, 0.0,	 0.6875, 0.375, 0.625, 0.375,
		];
		gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(textureCoords), gl.STATIC_DRAW);
		armLVTCB.itemSize = 2;
		armLVTCB.numItems = 24;


		legLVTCB = gl.createBuffer();
		gl.bindBuffer(gl.ARRAY_BUFFER, legLVTCB);
		var textureCoords = [
			0.0625, 0.0, 0.125, 0.0, 0.125, 0.375, 0.0625, 0.375,
			0.25, 0.0, 0.25, 0.375, 0.1875, 0.375, 0.1875, 0.0,
			0.0625, 0.5, 0.0625, 0.375, 0.125, 0.375, 0.125, 0.5,
			0.1875, 0.5, 0.125, 0.5, 0.125, 0.375, 0.1875, 0.375,
			0.1875, 0.0, 0.1875, 0.375, 0.125, 0.375, 0.125, 0.0,
			0.0, 0.0, 0.0625, 0.0, 0.0625, 0.375, 0.0, 0.375,
		];
		gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(textureCoords), gl.STATIC_DRAW);
		legLVTCB.itemSize = 2;
		legLVTCB.numItems = 24;

		cubeVertexIndexBuffer = gl.createBuffer();
		gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, cubeVertexIndexBuffer);
		var cubeVertexIndices = [
			0, 1, 2,			0, 2, 3,		// Front face
			4, 5, 6,			4, 6, 7,		// Back face
			8, 9, 10,		 8, 10, 11,	// Top face
			12, 13, 14,	 12, 14, 15, // Bottom face
			16, 17, 18,	 16, 18, 19, // Right face
			20, 21, 22,	 20, 22, 23	// Left face
		]
		gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(cubeVertexIndices), gl.STATIC_DRAW);
		cubeVertexIndexBuffer.itemSize = 1;
		cubeVertexIndexBuffer.numItems = 36;
	}

	function updateTexture() {

		// TODO Opera gets here, for some reason… 

		loadedImage = false;
		gl.bindTexture(gl.TEXTURE_2D, skintexture);
		gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);
		var texels;
		skineditormc.save();
		try {
			try {
				texels = skineditormc.getImageData(0, 0, 64, 32);
			} catch(e) {
				// if we, as the user, have asked for a local file, we expect to be able to use it
				// TODO: no idea what to do for Chrome here
				netscape ? netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead") : true;
				texels = skineditormc.getImageData(0, 0, 64, 32);

			}
		} catch(e) {
			console.log("unable to access image data: " + e);
		}
		skineditormc.restore();
		gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, texels);
		gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
		gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
		gl.bindTexture(gl.TEXTURE_2D, null);
		loadedImage = true;
	}

	// because localStorage has the poss. of updating in two tabs,
	// we need to sync them
	// XXX: assume localStorage and not sessionStorage changed. why would it?
	function updateSkinsFromAnotherTime(key) {

		// ERM. GREAT. so if the update is atomic,
		// we get spammed with updates for each item? :|

		// assume here that values have updated in another window
		// since it was fired, we know at least 1, it is supported, so ignore try{}?
		// ignorantly overwrite, for now
		//skins = JSON.parse(localStorage.getItem('skins'));
		//lastSkin = JSON.parse(localStorage.getItem('lastSkin'));
		console.log('someone else updated our skins');
	}

	/*
	* atm, we call this if we modify skins[]
	*/
	function updateSkins() {

		console.log('Store the updated skins.');
		// we want this to update the list of Skins stored, to easier allow the user to pop
		try {
			localStorage['skins']		= JSON.stringify(skins);
			localStorage['lastSkin']	= JSON.stringify(lastSkin);
		} catch (e) {
			console.log('failed to store skins ' + e);
		}

		// we have to iterate over the object, make sure we get arrays, check for:
		// .data, .thumb, .name
		// then push some thumbnails!

		holder.removeChild( skinsholder );
		// remove previous
		if ( skinsholder.hasChildNodes() ) {
			while ( skinsholder.childNodes.length >= 1 )
			{
				skinsholder.removeChild( skinsholder.firstChild );			 
			} 
		}

		// iterate and add skins to GUI!
		for (obj in skins) {
			
			obj = skins[obj];
			if (obj.thumb != null) {

				var temp = document.createElement('div');
				temp.className = 'box'; // TODO DOMy method please.
				var name = document.createElement('p');
				var preview = document.createElement('img');
				preview.addEventListener('click', function() { loadSkinInSkins( this.skin ); }, true);
				name.addEventListener('click', function() { renameSkinInSkins( this.skin ); }, true);
				preview.src = obj.thumb;
				preview.width
				name.innerHTML = obj.name;
				preview.skin = name.skin = obj.name;
				temp.className = 'box';
				temp.appendChild(name);
				temp.appendChild(preview);
				skinsholder.appendChild(temp);
			}
		}

		// update DOM with… laziness
		holder.appendChild(skinsholder);
		
	}


	function renameSkinInSkins( skin ) {

		if (skin == "") 
			return;

		console.log('Renaming ‘' + skin + '’ skin.');

		skinName = prompt('What do you wish to rename ‘' + skin + "’ to?\nTo delete, rename to ''.", skin);
		
		if (skinName === null) { // user aborted
			return;
		} else if (skinName === "") { // user wants to delete
			console.log('Deleting ‘' + skin + '’ skin.');
			deleteSkinInSkins(skin);
		} else {
			skins[skinName] = skins[skin];
			skins[skinName].name = skinName;
			delete skins[skin];
			updateSkins();
		}
	}

	function loadSkinInSkinsButton(e) {

		loadSkinInSkins("");
		e.preventDefault();
		return false;
	}

	function loadSkinInSkins(skin) { 

		console.log('Loading ‘' + skin + '’ skin.');
		if (skin == "") {
			skinName = prompt('Which skin do you want to load?', lastSkin);
		
			if (skinName == null) { // user aborted
				skinName = lastSkin
				return;
			}
		} else {
			skinName = skin;
		}

		if (skins[skinName]) {

			// so when we go to save, use correct name.
			// and store latest?
			lastSkin = skinName;
			localStorage['lastSkin']	= JSON.stringify(lastSkin);

			var newskin = document.createElement('img');
			newskin.onload = loadNewSkin;
			newskin.width=64; newskin.height=32;
			newskin.src = skins[skinName].data;
		} else {
			console.log( skinName + " does not exist" );
		}
	}

	function resetLocalStorage() {

		console.log('Purging localStorage');

		if (localStorage && localStorage.clear)
			localStorage.clear();
		else {
			localStorage = {};
		}
		// reset to defaults
		skins = initialSkins.clone();
		lastSkin = new String(initialLastSkin);

		updateSkins();
	}

	function deleteSkinInSkins(skin) {

		if (skin) {
			skins[skin] = {}
			delete skins[skin];
			updateSkins();
		}
	}

	function saveSkinInSkinsButton(e) {
		saveSkinInSkins("");
		e.preventDefault();
		return false;
	}

	function saveSkinInSkins(skin) {

		if (skin == "") {
			skinName = prompt('Please name your skin: ', lastSkin);
			if (skinName == null) {
			skinName = lastSkin
			return;
			}
		} else
			skinName = skin;

		console.log('Saving ‘' + skinName + '’ skin.');

		// generate a thumbnail!
		var skinthumb = document.createElement('canvas');
		skinthumbc = skinthumb.getContext('2d');
		skinthumb.width=70; skinthumb.height=100;
		// TODO for browsers without WebGL, but with canvas, this will produce something empty
		skinthumbc.drawImage(skinpreview, 0, 0, 70, 100);
		var sthumbnail, sskin;
		try {
			try {
				sthumbnail = skinthumb.toDataURL();
			} catch(e) {
				netscape ? netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead") : true;
				sthumbnail = skinthumb.toDataURL();
			}
		} catch(e) {
			console.log("unable to access image data: " + e);
		}
		console.log(skinName + ": " + sthumbnail );

		try {
			try {
				sskin = skineditorm.toDataURL()
			} catch(e) {
				netscape ? netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead") : true;
				sskin = skineditorm.toDataURL()
			}
		} catch(e) {
			console.log("unable to access image data: " + e);
		}
		console.log(skinName + ": " + sskin );

		// TODO: for now, overwrite is default
		// or, we could use bung it into skins[]?
		skins[skinName] = {
			name: skinName,
			data: sskin,
			thumb: sthumbnail,
		}
		lastSkin = skinName;
		updateSkins();
	}

		/*
		 * helper function
		 * replace this will inline code & a loop instead.
		 * ie, avoid function call
		 */
	function drawAndTexture(vertices, texture) {
		gl.bindBuffer(gl.ARRAY_BUFFER, vertices);
		gl.vertexAttribPointer(shaderProgram.vertexPositionAttribute, vertices.itemSize, gl.FLOAT, false, 0, 0);
		gl.bindBuffer(gl.ARRAY_BUFFER, texture);
		gl.vertexAttribPointer(shaderProgram.textureCoordAttribute, texture.itemSize, gl.FLOAT, false, 0, 0);
		gl.activeTexture(gl.TEXTURE0);
		gl.bindTexture(gl.TEXTURE_2D, skintexture);
		gl.uniform1i(shaderProgram.samplerUniform, 0);
		gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, cubeVertexIndexBuffer);
		setMatrixUniforms();
		gl.drawElements(gl.TRIANGLES, cubeVertexIndexBuffer.numItems, gl.UNSIGNED_SHORT, 0);
	}

	var xHead = 0, yHead = 0;

	function drawScene() {

		if (!loadedImage)
			return;

		gl.viewport(0, 0, gl.viewportWidth, gl.viewportHeight);
		gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);

		perspective(45, gl.viewportWidth / gl.viewportHeight, 0.1, 100.0);
		loadIdentity();

		// move to the plain we want
		mvTranslate([0.0, 0.5, -13.0])

		// we rotate everything
		mvRotate(xHead, [0, 1, 0]); 

		// draw body
		mvPushMatrix();
			drawAndTexture(bodyVPB, bodyVTCB);
		mvPopMatrix();

		// arms
		mvPushMatrix();
			mvTranslate([-1.5, 0.0, 0.0]);
			mvRotateAbout(25, [1, 0, 0], [-0.5, 1.5, 0]);
			mvRotateAbout(-5, [0, 0, 1], [-0.5, 1.25, 0]);
			drawAndTexture(armVPB, armLVTCB);
		mvPopMatrix();
		mvPushMatrix();
			mvTranslate([1.5, 0.0, 0.0]);
			mvRotateAbout(25, [1, 0, 0], [-0.5, 1.25, 0]);
			mvRotateAbout(5, [0, 0, 1], [-0.5, 1.25, 0]);
			mvScale([-1.0,1.0,1.0]);
			drawAndTexture(armVPB, armLVTCB);
		mvPopMatrix();

		// legs
		mvPushMatrix();
			mvTranslate([-0.5, -3, 0.0]);
			mvRotateAbout(10, [1, 0, 0], [0, 1.5, 0]);
			drawAndTexture(legVPB, legLVTCB);
		mvPopMatrix();
		mvPushMatrix();
			mvTranslate([0.5, -3, 0.0]);
			mvRotateAbout(-10, [1, 0, 0], [0, 1.5, 0]);
			mvScale([-1.0,1.0,1.0]);
			drawAndTexture(legVPB, legLVTCB);
		mvPopMatrix();

		// draw head
		mvPushMatrix();
			mvTranslate([0.0, 2.6, 0]);
			mvRotateAbout(xHead, [0, 1, 0], [0, -1.0, 0]); 
			mvRotateAbout(yHead, [1, 0, 0], [0, -1.0, 0]);
			mvRotate( 5, [1, 0, 0]);
			drawAndTexture(cubeVPB, headVTCB);
			// 1.125 puts it as 9,9,9
			mvScale([1.125,1.125,1.125]);
			drawAndTexture(cubeVPB, headAccessVTCB);
		mvPopMatrix();
	}


	var lastTime = 0;
	function animateScene() {

		var timeNow = new Date().getTime();
		if (lastTime != 0) {
			var elapsed = timeNow - lastTime;

			xHead -= ( cursorDiffX*2 )
			yHead -= ( cursorDiffY*2 )
			//if (yHead >= 32)
			//	yHead = 32;
			//if (yHead <= -50)
			//	yHead = -50;

			cursorDiffX= cursorDiffY = 0
		}
		lastTime = timeNow;
	}

	/**
	 * we only want to ‘animate’ when the user rotates, otherwise, just
	 * redraw
	 */
	var timerDrawing, timerAnimation;
	var cursorThen = [0,0], cursorNow = [0,0];
	var skinimporterchrome;
	var skintexture;

	function tick() {
		animateScene();
		drawScene();
	}

	function startRotatingDude(e) {

		if (!fWebGLSupport)
			return;
		skinpreview.style.cursor='move';
		if (!e) e = window.event;
		clearInterval(timerDrawing);
		// store mouse X/Y
		cursorThen = [e.clientX, e.clientY];

		timerAnimation = setInterval(tick, 100);
	}

	function captureCursorLocation(e) {
		if (!e) e = window.event;
		// what we really want to do:
		// rotate body on X, rotate head on Y (within bounds)
		cursorNow = [e.clientX, e.clientY];
		cursorDiffX = cursorThen[0] - cursorNow[0]
		cursorDiffY = cursorThen[1] - cursorNow[1]
		cursorThen = cursorNow
	}

	function stopRotatingDude() {

		if (!fWebGLSupport)
			return;
		skinpreview.style.cursor='pointer';
		clearInterval(timerAnimation);
		// we should only redraw if: 1, invalidate 2, user draws 3, burn GPU
		timerDrawing = setInterval(drawScene, 1000);
	}

	function toggleAnimation() {

		if (!fWebGLSupport)
			return;
		animate = !animate;
	}

	function drawOnDude(ev) {
		var x, y;
		clearInterval(timerDrawing);
		if (!ev) ev = window.event;
	
	// Get the mouse position relative to the canvas element.
	if (ev.layerX || ev.layerX == 0) { // Firefox
		x = ev.layerX; y = ev.layerY;
	} else if (ev.offsetX || ev.offsetX == 0) { // Opera
		x = ev.offsetX; y = ev.offsetY;
	}
		// border?
		x -=2; y -=2;
		// now we need to clamp them to 64×32
		x -= x%8; y -= y%8;

		skineditormc.clearRect( x/8, y/8, 1, 1);
	// XXX moved back above the webgl update, incase browser doesnt support it
		skineditorc.clearRect( x, y, 8, 8);

		if (fWebGLSupport) {
			updateTexture();
			drawScene();
			timerDrawing = setInterval(drawScene, 1000);
		}

	}

	function loadSkinFromFile(e) {

		console.log('loadSkinFromFile called.');
		//
		if (skinimporterchrome.files) {
			var oF = skinimporterchrome.files[0];
			console.log('Loading skin from file ‘' + oF.name + '’ using FileAPI.');
			var newskin = document.createElement('img');
			newskin.onload = loadNewSkin;
			newskin.file = oF;

			// For Chrome that doesn’t wont to load via .file 
		    var reader = new FileReader();
			reader.readAsDataURL(oF);
			reader.onload = function () {
				console.log('I got here');
			}
			/*reader.onload = (function(aImg, read) { return function(e) { console.log(read.data); aImg.src = e.target.result; }; })(newskin, reader);*/
			console.log(reader);

		} else {
			// We are positively in a non‐HTML5 browser. Firefox 3.6?
			console.log('Loading skin from file ‘' + skinimporterchrome.value + '’.');
			var newskin = document.createElement('img');
			newskin.onload = loadNewSkin;
			newskin.src = skinimporterchrome.value;
		}
		e.preventDefault();
		return false;
	}

	function roundNumber(num, dec) {
		return Math.round( Math.round( num * Math.pow( 10, dec + 1 ) ) / Math.pow( 10, 1 ) ) / Math.pow(10,dec);
	}

	/* Image.onload function */
	function loadNewSkin() {

		console.log('loadNewSkin called.');
		skineditor.width = skineditor.width; // need a .clear
		// if we are mozilla, tell them to stop SMOOTHING OUR SHIT
		skineditorc.mozImageSmoothingEnabled ? skineditorc.mozImageSmoothingEnabled = false : true;
		// TODO OPERA SMUDGES THIS SHIT
		skineditorc.clearRect(0,0,512,256);
		skineditorc.drawImage( this, 0, 0, 512, 256 );

		skineditormc.clearRect(0,0,512,256);
		skineditormc.drawImage( this, 0, 0, 64, 32 );

		if (fWebGLSupport)
			updateTexture();
	}


	/* because JS lacks it */
	/* http://my.opera.com/GreyWyvern/blog/show.dml/1725165 */
	Object.prototype.clone = function() {
		var newObj = (this instanceof Array) ? [] : {};
		for (i in this) {
			if (i == 'clone')
				continue;
			if (this[i] && typeof this[i] == "object") {
			  newObj[i] = this[i].clone();
			} else 
				newObj[i] = this[i]
		}
		return newObj;
	};


	var skinpreview; 	// our WebGL canvas

	var skineditor,		// our drawing canvas
		skineditorc, 	// our drawing canvas context
		skinsholder;

	var skins = {},		// our storage pool for drawings
		initialSkins = {},
		lastSkin,		// our default skin to open
		initialLastSkin;

	// TODO: rename to loadedSkin?
	var loadedImage = false; // delay 3D scene if canvas is slow.

	var animate = true; // allow our little guy to agitate
	// features we want to use, test for ’em
	var fDataUrlSupport 	= false,
		fJSONSupport		= false,
		fCanvasSupport 		= false,
		fWebGLSupport 		= false,
		flStorageSupport	= false;

	/*
	 * Boot our editor
	 */

	function init() {

		// discover console and fake up a work‐around
		if (!console) {
			console = {}
			console.log = function(message) {
				alert(message);
			}
		}
		// push messages to Opera debug
		if (window.opera && opera.postError)
			console.log = opera.postError

		// default SKINS setup
		// TODO: make this an ‘initial’ blob, so that if localStorage is purged, we can restore
		skins = {};
		initialSkins = {};
		initialSkins['default'] = {
			name: 'default',
			data: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAgCAMAAACVQ462AAAA8FBMVEUAAAAfEAsjFwkkGAgkGAomGAsjGRUmGgomGgwoGg0nGwsoGwooGwsoHAspHAwyFxQqHQ0rHg0rHg4tHQ4sHg4sHhEvHw8tIBAvIA0vIhEyIxAzJBE0JRI6KBQ/KhVCKhJSKCZLLh0aSxpRMSU/Pz9iQy9qQDBSPYkkcCR1Ry8jfiOKTD2EUjGBUzmGUzSHVTuHWDqIWjmKWTuTW0Jra2uWX0GaY0ScY0WaZEqcZ0ifaEmcaUydak+iakeWb1ucclysdlqqfWaze2K1e2etgG20hG23gnK2iWy+iGy7iXK9i3K9jnK9jnTGloD///8AAABxqeaaAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfbAgkTHQUig98cAAAB30lEQVRIx7WUC1PTQBSFu4R2aRc2CV22QkWNlNAK3QBxixWMJoqKj/b//xvvzWaZTjuaB+OZTPcmM+fL2fQkrVYhz3PgcMikUKuuPEdKADiTUIVKNQFISQ1gCQrrAxyJe5BeYwB4KZVPAeR+C3jVAEAlpwQBuRoAOAV5Xu2/kTHa40eDwTNf7jnU9waDI96jjNleVAFQwf2h7/vDly/E3tDngiKg6EUpQLQp39/d5v63n79//Pr0nG/v7nPaFrYX5Qm6fcF64jC9T798fLi9PRQ9JvpdZntRYQtsZ+vy5vh+cfb54WyRHt9cbu3ARduLCoBu++BCX2XZ1yD4nmVX+uKg3cWHaHpR/gxY//RupuI4C87PgyyO1ezutM+E7UUpQKmZmuvrOI4DECzX7+fv5jN4IbEXE1WpC2MQFtieFx8Fsiz0eB0UnoQn5QBT5/8DAH/4pC1sAND8BoTraxDJNf0wnZJ/qgRANvyu69qhEmBTtQGLhXXmB2mewAC01lEKimDAtTrAXQEkaaqjuoA8gUsiA0hyQJI0AuCdERDVTGAEPgPQa4DRyAJGo7egvwG0AaQak8BWVgDGaFdMgWnGHXDh3MGhMzaAJM2TrAKWa3oEAKGYOwR+8M7gS6K1BH8A2DSJHSt8yKwAAAAASUVORK5CYII=',
			thumb: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAABkCAYAAAA7Ska5AAACv0lEQVR4nO3ZsUsbYRzG8RuLwVYDgSoahZwisW0GXUREdMlQp4pLLQgOlZocLYftEixnCei1kEXI5OQodTLaIcTRf+vXobyvL7m75FIveX+5ew6+g4nmnvtgwqGGgSPwcJBv2gdwTfsArmkfwDXtA7imfQDXtA/gmvYBXNM+gGv9P0lhdpREi9l/FWZeyBamUrQwlSLz5TPZ/OQIzU+OyO9fzI5SfvoxwAAmPMzr2bF4wKgX59eSOU5L5jht5tOy9XyG1vMZepV9LhOAg9gMGC4wd26Z7twytWq27KHu0EPdodYv+7HaEbVqR/T723vZ8lyalufSgAFMUmGujj+SqFG1qFG1SH3s2rHo2rHowv4ga7o2NV2bLj5teQJM3GEERqNqkTjerbmy28oB3VYOJEbTteVz6iEgAQOYhMLcVPapvT8/bNnbN9Oe7s/KdH9W9vzcTWUfMLGHOd/dJJG4OBXh59aaJ/GcCiJeAzCAAYzM73PFL7+fBUzcYb4WCxRl6mvPjKXILxYwQeO6dbK9QifbK3R5WKTLw6L8Wu1/Xxsw/cPRgwKYHoCiAgFM3GH6FWAAAxjyOwADmBi/lcTfYQd90eq/X4JiAdOp053VgaMkEuZ0Z9VzjvrnXRkrGL9h/YKp720AJpYw8rG9jcjfSoHnAoz3XEPz4SvG9+OtFPS2HSqYqH9jYgNjGNHeIQMmrjDqwChhejkvYLjDBN1PmF9M6qXcRIZyE5muMJ1uLFnCtA8cJIz62aYNptMdqDowahi/8yQCph1IReoE89TriQwmbKEQvudCNaDNgNEKE/aiAQMYwAAGMIABDGAAAxjAAAYwgAEMYAADGMAABjCAAQxgEgJTKpUoqgCTBBjDMKhbgHl6sYIJE2ACAswQpH0A17QP4Jr2AVzTPoBr2gdwTfsArmkfwDXtA7imfQDL/gI0JtXz/KxIpQAAAABJRU5ErkJggg==',
		}
		initialSkins['honeydew'] = {
			name: 'honeydew',
			data: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAgCAYAAACinX6EAAADG0lEQVRogd1YO26kQBDlCg4mICCzLDn12KlTEvLdDYcT+Ba2z0BqiXCEJpjABARIHACJjMDyPeiNqlUUVf1zW7PrlkpjaLrp9/pV9cNJYmnloVSm+Ly7Usf9TnV5pj7vrvQ1/G2b/59vAPTPr9+rgPtdnongj/vdzyAAAGPw8AuA4bfLs5UiLr3+Lzdu9zERsNtUBT+GgKauVpLHKdHU1QZw7BRo6ko1dbWZR7ofvQEBmAS4bupKA/94e14FEBHj/RclwFYEOfAQXZ79/ylgOwYl8BCXXr+1caCaujKCjjWmPJTRpB2cEtyi5nHwBhIyhiNgHgc1j4M3kNBxSf74oGjM47C6vr25ZsM0xjWSJEnovPM4qNubaw1Gej/uhzFSvzg+ZNExw7QG0yZF63+5T5UUUMiKotgUN3zPNIctvCUbu1Hrukwn7eyW6aSW6aTSNN0YnjRNdT8Yn2U66WeoIaImCTtFaqW5DymXPjo/xii6VLo4AAH3AOAynVRRFKooitU9OpZzhjZCKHj6dcn5CeijxFKisCOFeVbX3O5zllby+/RllBQXn4CVgH+h0Z3lXCZcU5DejRYK27FFW5dnLNDjfqfyxwedNlLY5ueOUnxaBYGmBOAFSZVVarBT1BJ3eRaVgL49rwiAYzk6AdLZKjXTl+F3EhBVASYTZBvPVVvI3e9MgWAFSCahb8+qb89WI0MB4CJFq7rPPBCShbaty7VmiTbRNbhF41MBBywOagMF40qAi5KAhCACJPm7EkCPwuN+p9X08fa8Ate3Z/1OuE+f8QWPSfAmAMvHhQTp5SD/Ls80yL49b3YX5y+AwwS4pkpoTWHPfch/l1zjXvr++qQdJa4pGBglgKYCfTY0vBTAGR+bCmwSxHnP5TcmABfdGOC9CYiVAlQl0m6Wh1LPw6mBm8s3vAn4ShHkFmCSMnaLkhpC/svkY903KcCFiQBpDABzlSqnANP80RQgFUCfQiiBfn990gXRhQApHXxqEt0cKwF4YpPrkvqwjDEg/GnsQoAtHbjNcFGlcwrYCAg5BXxJkNQQogLAY8P/F6CbuIFTQdIoAAAAAElFTkSuQmCC',
			thumb: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAABkCAYAAAA7Ska5AAACz0lEQVR4nO3bPXLbMBAFYF7BhQsW7DKZcRuPWrVseIn4BDmCO0/ukd6FCxVRwUJncJ/JPYxUK8OYBbAMQe+CeJp5DUeiFp8N4odU1+EVfT0ibNQLsBr1AqxGvQCrUS/AatQLsBr1AqxGvQCrUS/Aarb/kofvD650AAMYwNSA8rkwd1+/rM6uYMbjwY3HQxGY8XgATDMwpQIYwDQK8+fXk6NM0+SmaXL+sVTo/f5nAAOYRmHeXl8cpe971/e9+/vt5pp5HNw8Dh+O+aHP0DkA0xIM1/AcDGVXMBzAPA7Ox/KvI5QUJAUwLcFIu9Lz/e0+YXyc5/vba1LXmnkcou+dx2Ef15iue5/HlIAJ5zEbbmatb7hk1y3V2CUw4/FwPeflfHKX86kumLDoVIO5awy9x8eiRaT/HRtugW7/31IahksVMFzhkuE3F8AshHl7fWGBzMCECLmE3YbrSnStupxPyfMDJgNTcKdvHQzXXTRgOKBqYcLRyB+BCMO/dULHqoBZirE1jJ+qYH7//HENHaNuw10n/K5ESwvAtAQjHVEo/sb40vMCBjA7g/GHcult2BQGNzUwPcFLLfBKw0hSBcwSjFy3iZ3P/OpastpeA8MhVLHtEIaehCoFQ8/i5f4IqjDSvp6DWDLqSKEBYxkm9UBh173fQuEa6i8TwuVCbH6Se4ARMNZhuPgwXAPDpxi4JxtyMOa7UgxFA8bUcJ3qUlvCcF2oepgYUOyYBGZte4rBSCOB8Telwg3wgtcOWzCSeQdgEhCAYWCkv0DZFUyJn+QAJjI/AUyLMLlZMmCYBnPTem4TalcwkgYDJtJg7uFGP4XWQLZgJA0GDGD+H2bD2yI2YUqkORiMShiuAZMNlgSAWRbJ1qY0gAFMwzCSjW9pANMCDJYEgAEMYLQDGMBUHfUCrEa9AKtRL8Bq1AuwGvUCrEa9AKtRL8Bq1AuwGvUCTOYfXfp3gFneuucAAAAASUVORK5CYII=',
		}
		lastSkin = 'default';
		initialLastSkin = 'default';

		// discover if we have JSON library in the browser
		if (JSON) {
			fJSONSupport = true;
		} else {
			console.log('TODO: write thing. lols' );
		}

		// discover localStorage and enable if possible

		if (localStorage) {
			flStorageSupport = true;

			console.log('We have localStorage support.');
			if (localStorage['skins'] != null) {

				console.log('We have a session!');
				skins						= JSON.parse(localStorage['skins']);
				lastSkin					= JSON.parse(localStorage['lastSkin']);

			} else {

				console.log('We are starting a new session.');
				// copy values from defaults
				skins = initialSkins.clone();
				lastSkin = new String(initialLastSkin);
				try {
					localStorage['skins']	= JSON.stringify(skins);
					localStorage['lastSkin']= JSON.stringify(lastSkin);
				} catch (e) {
					// OOM seems unlikely with our usage needs.
					console.log('Had a problem setting up localStorage: ' + e);
				}
			}

			// Safari requires you to define your event listener on the body; IE requires it to be set on the document. Firefox doesn’t care.
			// SERIOUSLY?! bugger Safari. maybe Chrome too.
			document.addEventListener('storage',updateSkinsFromAnotherTime,false);

		} else {

			// we need to disable our ‘skins’ stuff, just do session editing
			// or, just ask the user for the name?
			console.log('We don’t have localStorage support.');
			localStorage = {};
			skins = initialSkins.clone();
			lastSkin = new String(initialLastSkin);
			localStorage['skins']	= JSON.stringify(skins);
			localStorage['lastSkin']= JSON.stringify(lastSkin);
			// what we could always do, is localStorage = {}, use it like a assoc. array
			// might even simplify things
		}

		// discover dataURL support and continue
		// takes too long. All browsers that do canvas currently also support data:
		// so assume. :\
		/*
		var dataTest = document.createElement('img');
		dataTest.onload = dataTest.onerror = function() {
			console.log('testing');
			if (this.width == 1 && this.height == 1)
				fDataUrlSupport = true;
		}
		dataTest.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";
		*/

		// discover canvas support and continue
		skineditor = document.getElementById( 'skin-editor' );

		if (skineditor && skineditor.getContext) {

			fCanvasSupport = true;
			skineditor.className += ' enabled';
			skineditorc = skineditor.getContext( '2d' );
			skineditor.addEventListener('click',			drawOnDude, true);

			// TODO: turn this back into a <canvas> because we need it for
			// the save image option
			skineditorm = document.createElement( 'canvas' );
			skineditorm.width = 64; skineditorm.height = 32;
			skineditormc = skineditorm.getContext( '2d' );

			holder = document.getElementById('container');

			skinimporterchrome = document.createElement('input');
			skinimporterchrome.id = 'skin-selector';
			skinimporterchrome.type = 'file';
			skinimporterchrome.accept = 'image/png'; // ask for PNG images
			skinimporterchrome.addEventListener('change',	 loadSkinFromFile, false);

			skinsaverchrome = document.createElement('input');
			skinsaverchrome.id = 'skin-saver';
			skinsaverchrome.type = 'submit';
			skinsaverchrome.value = 'Save';
			skinsaverchrome.addEventListener('click',	saveSkinInSkinsButton, false);

			skinloaderchrome = document.createElement('input');
			skinloaderchrome.id = 'skin-loader';
			skinloaderchrome.type = 'submit';
			skinloaderchrome.value = 'Load';
			skinloaderchrome.addEventListener('click',	loadSkinInSkinsButton, false);

			skinpurgerchrome = document.createElement('input');
			skinpurgerchrome.id = 'skin-puger';
			skinpurgerchrome.type = 'submit';
			skinpurgerchrome.value = 'Purge';
			skinpurgerchrome.addEventListener('click',		resetLocalStorage, false);

			// need to disable for Opera & Chrome, they refuse to open files
			holder.appendChild(skinimporterchrome);
			
			holder.appendChild(skinloaderchrome);
			holder.appendChild(skinsaverchrome);
			//holder.appendChild(skinpurgerchrome);

			// even without data: URL support, we want this gutter to display
			skinsholder = document.createElement('div');
			skinsholder.id='skins-container';
			holder.appendChild(skinsholder);

		} else {
			// We don’t have to do anything here, because we have fallback in HTML
		}

		// discover WebGL support and continue
		skinpreview = document.getElementById( 'skin-preview' );

		if (skinpreview && initGL( skinpreview ) != null) {

			fWebGLSupport = true;
			skinpreview.className += ' enabled';
			webGLStart();
		
			skinpreview.addEventListener('mousedown',		 startRotatingDude, true);
			skinpreview.addEventListener('doubleclick',		   toggleAnimation, true);
			skinpreview.addEventListener('mouseup',			  stopRotatingDude, true);
			skinpreview.addEventListener('mouseout',		  stopRotatingDude, true);
			skinpreview.addEventListener('mousemove',	 captureCursorLocation, true);
		} else {
			// We don’t have to do anything here, because we have fallback in HTML
			// maybe create a canvas perspective fallback?
		}
	
		// now that we are here, init our skin.
		loadSkinInSkins( lastSkin );
		// init our display of skins
		updateSkins();
	}

	function webGLStart() {

		initShaders()
		initBuffers();
		updateTexture();

		// if we put 0.0 for alpha, we see the background!
		gl.clearColor(0.0, 0.0, 0.0, 0.5);
		gl.clearDepth(1.0);
		gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);
		gl.enable(gl.BLEND);

		//gl.enable(gl.ALPHA_TEST);
		//gl.alphaTestFunc(gl.LEQUAL);

		gl.enable(gl.DEPTH_TEST);
		gl.depthFunc(gl.LEQUAL);

		timerDrawing = setInterval(drawScene, 1000);
	}


document.addEventListener("DOMContentLoaded", init, false);
</script>


</head>
<body>

<header><h1><span id="minecraft">Minecraft</span> Skin Editor</h1></header>

<section>
<article id="container">
	
 <style>
	html, h1, article, p, div { margin: 0; padding: 0; }
	@font-face { font-family: Munro; src: url(i/munro.ttf); }

	body { background: url(i/bg.gif) #eeeeee; margin:0; font-family: Munro, sans-serif; }
	#minecraft { background: url(i/minecraft.png) transparent no-repeat; display: inline-block; text-indent: -9999px; min-width:270px; min-height: 60px; }
	header { margin: 0; font-family: Munro, sans-serif; color: white; background: url(i/top-bg.gif) repeat-x transparent; height:60px; }

	canvas, .box { border: 2px solid grey; background: transparent; background: rgba(0,0,0,0.4); font-family: Munro, monospace; border-image: url(i/window-border.png) 10 stretch stretch; }

	.sign { padding: 6px 4px; text-align:center; color: black; margin: 2px; border: 0; background: url(i/sign.png) no-repeat #ab8c55; background-size: 100% 100%; }

	#skin-preview, #skin-editor, #wip, #skins-container { position: absolute; }
	#wip, #skins-container { left: 374px; width: 512px; }

	#wip { font-size: 115%; top:330px; left: 438px; height: 130px; width: 324px; }
	#wip code {font-family: Munro, monospace; }
	#wip a { color: black !important;}

	/* skin preview box */
	#skins-container { padding:0; top: 445px; height: 148px; min-width:260px; overflow: auto; overflow-y: hidden; white-space: nowrap; }
	#skins-container:empty { display:none; }
	#skins-container div { padding: 2px 4px; display: inline-block; text-align: center; height: 124px; width: 80px; overflow: hidden; }
	#skins-container p { color: white; background: transparent; overflow: ellipsis; }
	#skins-container div img { margin: 0 5px;}

	#skins-container div img, #skins-container div p { cursor: pointer; }

	#skin-editor, #skin-preview { top: 60px; }
	#skin-editor { left: 374px; }
	#skin-preview { left: 10px; }

	/* if the user doesn’t have JS, or Canvas support, no point doing this */
	#skin-preview.enabled { cursor: pointer; }
	#skin-editor.enabled  { cursor: crosshair; background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH2wIODxsDFVG/AgAAAClJREFUGNNjvHnz5n8GJKCmpobMZWBiIAAoV8D4//9/FDfcunWL3m4AADstCpWDR4PDAAAAAElFTkSuQmCC); }

	#skin-preview:after { content: "."; display: block; height: 0; clear: both; visibility: hidden; }
	#skin-selector, #skin-saver, #skin-loader { position: absolute; top: 570px; }
	#skin-selector { left: 10px; }
	#skin-saver { width: 55px; left: 310px; }
	#skin-loader { width: 55px; left: 255px; }
	footer { color: black; background: transparent; position: absolute; bottom: 2px; height: 50px; }

 </style>

 <p id="wip" class="sign box">Work‐in‐progress. Please send suggestions to jdrinkwater@gmail.com. Code history <a href="">here</a>, licensed AGPL where applicable. <br/>
© <A href="http://johndrinkwater.name/">JD</a>, <a href="">Mojang</a>, <a href="http://www.tenbytwenty.com/munro.php">10×20</a>, <a href="http://learningwebgl.com/blog/">learningWebGL</a>.<br />
Demo of: <code>&lt;canvas&gt;</code>, <code>WebGL</code>, &amp; <code>localStorage</code>.</p>

 <canvas id="skin-preview" width="350" height="500">
  <img src="i/3d-tease.png" width="350" height="500" alt="Minecraft Default Skin Preview" />
  <p>Sorry, you browser does not support WebGL. Pretend the above image is rendered by your graphics card in real‐time.</p>
 </canvas>

 <canvas id="skin-editor" width="512" height="256">
  <img src="i/char.png" width="512" height="256" alt="Minecraft Default Skin" />
  <p>Sorry, your browser does not support Canvas. Which kinda makes this whole application redundant.</p>
 </canvas>

 <!-- make a preview/save skin lightbox here -->
 <!--<canvas id="skin-editor-mini" width="64" height="32"></canvas>-->

 <noscript><p>While I’m the first person to complain about the needs of JavaScript for many a‐website, this is an ‘application’, it can’t run without the code being used. Please toggle NoScript, or try this in a browser that supports JavaScript.</p></noscript>

</article>
</section>

<!-- <footer><p>Everything <a href="http://creativecommons.org/licenses/by-sa/2.0/deed.en_GB"><svg xmlns="http://www.w3.org/2000/svg" style="vertical-align:middle; padding-bottom:3px; width:.95em; height: .95em;" width="16px" height="16px" viewBox="-2 -2 66 66"><circle cx="32" cy="32" r="28" fill="none" stroke="black" stroke-width="7px" /><path d="m19.63,41.14 c-2.8,-1 -5.1,-4 -5.5,-7.43 -0.6,-5.06 1.327,-9 5.2,-10.75 2.1,-0.96 5.93,-0.93 8.2,0.05 1.4,0.6 4,3 4,3.6 0,0.1 -0.9,0.64 -2,1.17 l-2,1 c-0.87,-1.06 -1.9,-1.74 -3.1,-2.3 -1.37,-0.26 -3,0.35 -3.74,1.4 -1.23,1.72 -1.3,6.2 -0.15,7.974 0.6,0.92 1.6,1.6 2.6,1.6 2,0.16 2.5,-0.02 3.7,-1.26 l1.2,-1.26 1.54,0.85 c0.85,0.47 1.66,0.96 1.8,1.1 0.52,0.47 -1.86,2.9 -3.77,3.85 -1.63,0.8 -2.14,0.92 -4.3,0.9 -1.34,-0.013 -3,-0.22 -3.67,-0.46z m18.32,0 c-2.8,-1 -5.1,-4 -5.5,-7.43 -0.6,-5.06 1.327,-9 5.2,-10.75 2.1,-0.96 5.93,-0.93 8.2,0.05 1.4,0.6 4,3 4,3.6 0,0.1 -0.9,0.64 -2,1.17 l-2,1 c-0.87,-1.06 -1.9,-1.74 -3.1,-2.3 -1.37,-0.26 -3,0.35 -3.74,1.4 -1.23,1.72 -1.3,6.2 -0.15,7.974 0.6,0.92 1.6,1.6 2.6,1.6 2,0.16 2.5,-0.02 3.7,-1.26 l1.2,-1.26 1.54,0.85 c0.85,0.47 1.66,0.96 1.8,1.1 0.52,0.47 -1.86,2.9 -3.77,3.85 -1.63,0.8 -2.14,0.92 -4.3,0.9 -1.34,-0.013 -3,-0.22 -3.67,-0.46z" fill="black" stroke="black" stroke-width="1px" /><switch><g></g><foreignObject width="2em" height="1em">CC</foreignObject></switch></svg> BY‑SA</a> John Drinkwater 2002–2011</p></footer> -->

</body></html>
